# 開発ガイド

このドキュメントでは、Todoアプリの開発でよく編集するファイルとディレクトリについて説明します。

## 📚 基礎知識

開発を始める前に、知っておくと便利な用語や概念を説明します。

### npm と package.json について

#### npm とは？

**npm**（Node Package Manager）は、JavaScriptのライブラリ（他の人が作った便利なコード）をインストールしたり管理したりするツールです。

**ライブラリの具体例**：

このプロジェクトで使っているライブラリの例：

- **React Router**：ページの切り替え（ルーティング）機能を提供
  - 自分で実装すると大変ですが、ライブラリを使えば簡単にページを作れます
- **Prisma**：データベースを操作する機能を提供
  - データベースへの接続やデータの取得・保存を簡単にできます
- **shadcn/ui**：きれいなボタンや入力欄などのUI部品を提供
  - 自分でデザインしなくても、すぐに使えるUIコンポーネントが用意されています

これらはすべて、世界中の開発者が作って公開してくれた便利なコードです。npmを使うと、これらのライブラリを簡単にインストールして使えます。

- `npm install`：ライブラリをインストールするコマンド
- `npm run dev`：開発サーバーを起動するコマンド
- `npm run build`：アプリをビルド（完成させる）するコマンド

#### package.json とは？

**`package.json`** は、プロジェクトの設定ファイルです。以下の情報が書かれています：

- **プロジェクト名**：このアプリの名前
- **依存関係**：このアプリが使っているライブラリのリスト
- **スクリプト**：よく使うコマンドのショートカット

#### よく使うコマンド

| コマンド                   | 説明                                                       |
| -------------------------- | ---------------------------------------------------------- |
| `npm install`              | `package.json`に書かれているライブラリをすべてインストール |
| `npm install ライブラリ名` | 新しいライブラリを追加（例：`npm install axios`）          |
| `npm run dev`              | 開発サーバーを起動（アプリを動かす）                       |
| `npm run build`            | アプリを完成させる（本番用にビルド）                       |

**注意**：これらのコマンドは、プロジェクトのルートディレクトリ（`package.json`がある場所）で実行してください。

---

### UIライブラリ（shadcn/ui）について

#### UIライブラリとは？

**UIライブラリ**は、ボタンや入力欄などの見た目が整ったUI部品を提供してくれるライブラリです。自分で一から作らなくても、きれいなボタンやフォームを簡単に使えます。

#### shadcn/ui とは？

このプロジェクトでは **shadcn/ui** というUIライブラリを使っています。

- **ボタン**（`Button`）：クリックできるボタン
- **入力欄**（`Input`）：テキストを入力する欄
- **カード**（`Card`）：情報を表示する箱
- **サイドバー**（`Sidebar`）：横に表示されるメニュー

など、よく使うUI部品が用意されています。

#### どこにある？

shadcn/uiのコンポーネントは `app/components/shadcn/` フォルダにあります：

```
app/components/shadcn/
├── button.tsx    # ボタンコンポーネント
├── input.tsx     # 入力欄コンポーネント
├── card.tsx      # カードコンポーネント
└── ...
```

#### どうやって使う？

他のファイルで使うときは、`import`で読み込みます：

```typescript
import { Button } from "~/components/shadcn/button";
import { Input } from "~/components/shadcn/input";

// 使うとき
<Button>クリック</Button>
<Input placeholder="入力してください" />
```

#### 新しいコンポーネントを追加したい場合

shadcn/uiから新しいコンポーネントを追加する場合は、以下のコマンドを実行します：

```bash
npx shadcn@latest add コンポーネント名
```

例：`npx shadcn@latest add dialog`（ダイアログを追加）

**注意**：通常は既存のコンポーネントを編集するだけで十分です。新しいコンポーネントが必要になったときだけ追加しましょう。

---

### React Router v7 について

#### React Router とは？

**React Router**は、Webアプリケーションで**ページの切り替え**（ルーティング）を実現するライブラリです。

**なぜ必要？**

通常のWebサイトでは、URLが変わると別のページが表示されます：

- `http://example.com/` → トップページ
- `http://example.com/about` → についてページ
- `http://example.com/contact` → お問い合わせページ

React Routerを使うと、JavaScriptで作ったアプリでも、同じようにURLに応じてページを切り替えられます。

#### React Router v7 の特徴

このプロジェクトでは **React Router v7** を使っています。

**主な機能**：

1. **ページのルーティング**：URLに応じて表示するページを切り替える
   - `/` → トップページ（`app/routes/_index.tsx`）
   - `/list/abc-123` → リスト詳細ページ（`app/routes/list.$id.tsx`）

2. **データの読み込み（loader）**：ページを表示する前に、データベースからデータを取得
   - ページが表示される前に必要なデータを準備できる

3. **フォーム送信（action）**：フォームを送信して、データベースに保存
   - ボタンを押したときに、データを保存したり削除したりできる

#### どこにある？

React Routerの設定は以下のファイルにあります：

```
app/
├── routes.ts              # ルーティングの設定（どのURLでどのページを表示するか）
├── routes/
│   ├── _index.tsx         # トップページ（/）
│   └── list.$id.tsx       # リスト詳細ページ（/list/:id）
└── root.tsx               # アプリ全体のルートコンポーネント
```

#### どうやって使う？

**新しいページを追加する場合**：

1. `app/routes/` に新しいファイルを作成（例：`about.tsx`）

```typescript
export default function About() {
  return <div>についてページ</div>;
}
```

2. 自動的に `/about` というURLでアクセスできるようになる

**データを読み込む場合（loader）**：

```typescript
export async function loader() {
  const lists = await listRepository.findAll();
  return { lists };
}

export default function Index({ loaderData }: Route.ComponentProps) {
  const { lists } = loaderData;
  return <div>{/* リストを表示 */}</div>;
}
```

**フォームを送信する場合（action）**：

```typescript
export async function action({ request }: Route.ActionArgs) {
  const formData = await request.formData();
  const listName = formData.get("listName") as string;
  await listRepository.create({ name: listName });
  return redirect("/");
}
```

#### よく使う機能

- **`Link`**：ページ間を移動するリンク（`<a>`タグの代わり）
- **`Form`**：フォーム送信（`<form>`タグの代わり）
- **`redirect`**：別のページにリダイレクト
- **`useNavigation`**：フォーム送信中の状態を取得

**注意**：React Router v7は、ファイルベースのルーティングを採用しています。`app/routes/` フォルダにファイルを作成すると、自動的にルート（URL）が作成されます。

---

### データベースについて

データベースの基本的な概念については、**別のドキュメント**で詳しく説明しています。

👉 **[データベース基礎知識](./データベース基礎知識.md)** を読んで、データベースとは何か、どうやって使うのかを学びましょう。

---

## 📁 プロジェクト構造の全体像

このプロジェクトのフォルダ構造は以下のようになっています：

```
todo/
├── app/                    # アプリケーションのメインコード（ここをよく編集します）
│   ├── routes/            # ページ（画面）の実装
│   ├── components/        # UIコンポーネント（ボタン、サイドバーなど）
│   ├── repository/        # データベース操作のコード
│   └── root.tsx           # アプリのルートコンポーネント
├── prisma/                # データベースの設定
│   └── schema.prisma     # データベースのテーブル定義
├── public/                # 画像などの静的ファイル
├── package.json          # プロジェクトの設定と依存関係
└── README.md             # プロジェクトの説明書
```

**注意**：この構造は、このプロジェクト（初心者向けのTodoアプリ）のために**シンプルに作られた構造**です。実際のプロジェクトでは、プロジェクトの規模や目的によって、フォルダ構造は大きく異なります。

- **小規模なプロジェクト**：このプロジェクトのようにシンプルな構造で十分
- **大規模なプロジェクト**：`features/`、`services/`、`utils/`、`hooks/`など、より細かく分類されることが多い
- **チーム開発**：チームの規約や好みによって構造が変わる

このプロジェクトでは、**初心者が理解しやすいように**、必要最小限のフォルダ構造にしています。

## 🎯 よく編集するファイルとディレクトリ

初心者が開発する際に、**最もよく編集する**ファイルとディレクトリを優先順位順に説明します。

### 1. `app/routes/` - ページ（画面）の実装 ⭐⭐⭐

**最も重要！** ここでアプリの各ページを実装します。

```
app/routes/
├── _index.tsx          # トップページ（リスト一覧）
└── list.$id.tsx        # リスト詳細ページ（Todoアイテム一覧）
```

#### 役割

- **`_index.tsx`**: アプリを開いたときに最初に表示されるページ
  - リスト一覧を表示
  - 新しいリストを作成するフォーム

- **`list.$id.tsx`**: 特定のリストを表示するページ
  - そのリストに含まれるTodoアイテムを表示
  - Todoアイテムの追加・編集・削除
  - リスト名の編集

#### よく編集する内容

- ページのレイアウト変更
- フォームの追加・変更
- ボタンの配置変更
- データの表示方法の変更

#### 例：新しいページを追加する場合

1. `app/routes/` に新しいファイルを作成（例：`about.tsx`）
2. そのファイルにページのコードを書く
3. 自動的に `/about` というURLでアクセスできるようになる

---

### 2. `app/components/` - UIコンポーネント ⭐⭐⭐

**2番目に重要！** ボタンやサイドバーなど、再利用できるUI部品を作ります。

```
app/components/
├── sidebar.tsx         # サイドバーコンポーネント
└── shadcn/            # UIライブラリのコンポーネント（通常は編集しない）
    ├── button.tsx
    ├── card.tsx
    └── ...
```

#### 役割

- **`sidebar.tsx`**: 左側に表示されるサイドバー
  - リスト一覧を表示
  - 新しいリストを作成するフォーム

- **`shadcn/`**: UIライブラリのコンポーネント
  - 通常は編集しません
  - ボタン、カード、入力欄などの基本的なUI部品

#### よく編集する内容

- サイドバーのデザイン変更
- 新しいコンポーネントの作成（例：Todoアイテムを表示するコンポーネント）
- 既存コンポーネントのスタイル変更

#### 例：新しいコンポーネントを作る場合

1. `app/components/` に新しいファイルを作成（例：`todo-item.tsx`）
2. コンポーネントのコードを書く
3. `app/routes/` のファイルで `import` して使う

---

### 3. `app/repository/` - データベース操作 ⭐⭐

**3番目に重要！** データベースからデータを取得したり、保存したりするコードです。

```
app/repository/
├── list.repository.ts    # リストのデータベース操作
├── item.repository.ts    # Todoアイテムのデータベース操作
└── prisma.ts            # データベース接続の設定（通常は編集しない）
```

#### 役割

- **`list.repository.ts`**: リストに関するデータベース操作
  - リストの作成、取得、更新、削除
  - 関数として実装されている

- **`item.repository.ts`**: Todoアイテムに関するデータベース操作
  - Todoアイテムの作成、取得、更新、削除
  - 関数として実装されている

- **`prisma.ts`**: データベース接続の設定
  - 通常は編集しません

#### よく編集する内容

- 新しいデータベース操作の追加（例：検索機能）
- 既存の操作の変更（例：並び順の変更）
- データの取得方法の変更

#### 例：新しい機能を追加する場合

`list.repository.ts` に新しい関数を追加：

```typescript
// リストを検索する関数を追加
search: async (keyword: string) => {
  return await prisma.list.findMany({
    where: {
      name: {
        contains: keyword,
      },
    },
  });
},
```

---

### 4. `prisma/schema.prisma` - データベースのテーブル定義 ⭐

**データベースの構造を変更するときに編集します。**

#### 役割

データベースにどんなテーブルがあって、どんなデータを保存するかを定義します。

#### よく編集する内容

- 新しいテーブルの追加
- 既存テーブルに新しいカラム（項目）を追加
- データの型を変更

#### 例：新しいカラムを追加する場合

```prisma
model List {
  id        String     @id @default(uuid()) @db.Uuid
  name      String
  color     String?    // ← 新しいカラムを追加
  // ... 他のカラム
}
```

変更後は、必ず以下を実行：

```bash
npx prisma migrate dev --name add_color_to_list
```

---

## 🔄 開発の流れ

実際に開発するときの流れを説明します。

### 1. 新しい機能を追加する場合

**例：Todoアイテムに「優先度」を追加したい**

1. **データベースの構造を変更** (`prisma/schema.prisma`)

   ```prisma
   model Item {
     // ... 既存のカラム
     priority Int?  // 優先度を追加
   }
   ```

2. **マイグレーションを実行**

   ```bash
   npx prisma migrate dev --name add_priority
   ```

3. **データベース操作を追加** (`app/repository/item.repository.ts`)

   ```typescript
   create: async (data: { title: string; priority?: number; ... }) => {
     return await prisma.item.create({ data });
   }
   ```

4. **UIを変更** (`app/routes/list.$id.tsx`)
   - 優先度を入力するフォームを追加
   - 優先度を表示するUIを追加

### 2. デザインを変更する場合

**例：ボタンの色を変更したい**

1. **コンポーネントを編集** (`app/components/sidebar.tsx` や `app/routes/list.$id.tsx`)
   - Tailwind CSSのクラス名を変更
   - 例：`bg-blue-500` → `bg-green-500`

### 3. 新しいページを追加する場合

**例：「設定」ページを追加したい**

1. **新しいファイルを作成** (`app/routes/settings.tsx`)

   ```typescript
   export default function Settings() {
     return <div>設定ページ</div>;
   }
   ```

2. **自動的に `/settings` でアクセス可能になる**

---

## 📝 ファイルの編集頻度まとめ

| ファイル/ディレクトリ  | 編集頻度           | 説明                         |
| ---------------------- | ------------------ | ---------------------------- |
| `app/routes/`          | ⭐⭐⭐ 非常に高い  | ページの実装・変更           |
| `app/components/`      | ⭐⭐⭐ 高い        | UIコンポーネントの作成・変更 |
| `app/repository/`      | ⭐⭐ 中程度        | データベース操作の追加・変更 |
| `prisma/schema.prisma` | ⭐ 低い            | データベース構造の変更時のみ |
| `app/root.tsx`         | ほとんど編集しない | アプリ全体の設定             |
| `package.json`         | ほとんど編集しない | 依存関係の追加時のみ         |

---

## 💡 初心者へのアドバイス

### まずはここから始めよう

1. **`app/routes/list.$id.tsx`** を開いて、コードを読んでみる
   - どんな構造になっているか理解する
   - 小さな変更（例：テキストの変更）をしてみる

2. **`app/components/sidebar.tsx`** を開いて、コンポーネントの作り方を学ぶ
   - コンポーネントとは何かを理解する

3. **`app/repository/item.repository.ts`** を開いて、データベース操作を学ぶ
   - どうやってデータを取得・保存するか理解する

### 編集するときの注意点

- **`generated/` ディレクトリ**: 自動生成されるファイルなので、**編集しない**
- **`node_modules/` ディレクトリ**: ライブラリのファイルなので、**編集しない**
- **`prisma/migrations/` ディレクトリ**: マイグレーションファイルなので、**直接編集しない**

### 困ったときは

1. エラーメッセージをよく読む
2. 既存のコードを参考にする（似たような機能を探す）
3. 小さく変更して、動作を確認する

---

## 🔗 関連ドキュメント

- [README.md](../README.md) - セットアップ手順
- [データベース基礎知識](./データベース基礎知識.md) - データベースの基本概念と使い方
- [Cursor拡張機能の推奨設定](./Cursor拡張機能の推奨設定.md) - 開発に便利な拡張機能の設定
- [Gitの運用方法](./Gitの運用方法.md) - ブランチ、コミット、プッシュ、プルリクエストの使い方
- [React Router 公式ドキュメント](https://reactrouter.com/) - フレームワークの使い方
- [Prisma 公式ドキュメント](https://www.prisma.io/docs) - データベース操作の詳細

---

Happy Coding! 🎉
